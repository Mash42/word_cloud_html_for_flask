<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Required link tags -->
        <link rel="stylesheet" href="/static/css/bootstrap.min.css">
        <link rel="stylesheet" href="/static/css/bootstrap-grid.min.css">
        <link rel="stylesheet" href="/static/css/bootstrap-reboot.min.css">
        <link rel="stylesheet" href="/static/font/css/open-iconic-bootstrap.css">
        <link rel="stylesheet" href="/static/css/c3.min.css">
        <!-- Required script tags -->
        <script src="/static/js/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
        <script src="/static/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="/static/js/vue_2.6.12.js"></script>
        <script src="/static/js/vuejs-pagenate_2.1.0.js"></script>
        <script src="/static/js/d3.v5.min.js"></script>
        <script src="/static/js/c3.min.js"></script>
        <script src="/static/js/d3.layout.cloud.js"></script>
        <!-- My Custom script tags -->
        <script type="text/javascript">
            $(function (){
                $(".word-cloud-text").on("click", function(){
                    alert($(this).text());
                })
                $(".word-cloud-text").on("mouseover", function(){
                    $(this).addClass("cursor-pointer");
                })
                $(".word-cloud-text").on("mouseout", function(){
                    $(this).removeClass("cursor-pointer");
                })
                $("#create_wordcloud_btn_id").on("click", function(){
                    $("#create_wordcloud_form_id").submit();
                    wordcloud_obj = $("#wordcloud");
                    $("#wordcloud_width_id").val(wordcloud_obj.width());
                })
                
            });
        </script>
        <style>
            .cursor-pointer {
                cursor: pointer;
            }
        </style>
        <title>ワードクラウド</title>
    </head>
    <body>
    {% if file_name %}
    <h1>{{file_name}}</h1>
    {% endif %}
    
    {% if wordcloud_width %}
    <h1>{{wordcloud_width}}</h1>
    {% endif %}
        <div class="container mt-1" id="app">
            <div class="row">
                <div class="col-6">
                    <form action="/create_wordcloud" 
                          method="POST" 
                          name="create_wordcloud_form" 
                          id="create_wordcloud_form_id">
                        <input type="hidden" name="wordcloud_width" id="wordcloud_width_id">
                        <div class="form-group">
                            <label for="input_sentence_id">文章</label>
                            <textarea name="input_sentence" id="input_sentence_id" rows="10"
                                      class="form-control" required>{{input_sentence}}</textarea>
                        </div>
                        <button class="btn btn-primary" id="create_wordcloud_btn_id">ワードクラウド作成</button>
                    </form>
                </div>
                <div class="col-6 text-center">
                    <label for="wordcloud">ワードクラウド</label>
                    <div id="wordcloud" class="w-100 h-100 border border-primary">
                        <object type="image/svg+xml"
                                data="/static/wordcloud/wordcloud.svg" 
                                class="wordcloud-object"
                                onload="svgLoading(this);"
                                loading="eager"
                                id="wordcloud-id">
                        </object>
                    </div>
                </div>
            </div>
        </div>
        <script>
            function svgLoading(obj){
                var svgDoc = obj.getSVGDocument();
                var text_tags = svgDoc.getElementsByTagName("text");
                for(text of text_tags){
                    text.addEventListener("click", function(e){
                        alert(this.innerHTML);
                    })
                }
            }
        </script>
    </body>
</html>